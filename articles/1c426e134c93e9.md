---
title: "ã€10 åˆ†ã§ä½œã‚Œã‚‹ã€‘Vercel AI SDK ã® useChat ã§ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å¯¾å¿œãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ"
emoji: "ğŸ’¬"
type: "tech"
topics: ["Vercel AI SDK", "useChat", "Next.js", "shadcn/ui", "Cursor Agent"]
published: false
---

æœ€è¿‘ Vercel AI SDK ã‚’ã‚ˆãä½¿ã£ã¦ã„ã¾ã™ã€‚ã‚‚ã†æœ¬å½“ã«æœ¬å½“ã«ä¾¿åˆ©ã§ã€ç”Ÿæˆ AI ã‚’ä½¿ã£ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œã‚‹ã®ã«ã“ã‚Œãªã—ã§ã¯ç”Ÿæ´»ã§ãã¾ã›ã‚“ã€‚

ä»Šå›ã®è¨˜äº‹ã§ã¯ã€Vercel AI SDK ã‚’ä½¿ã£ã¦åŸºæœ¬çš„ãªãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‚’ä½œã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ï¼

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

ç”Ÿæˆ AI ã¨ã®è¦ªå’Œæ€§ãŒé«˜ã„ `shadcn/ui` ã‚’ä½¿ã£ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚Šã¾ã™ã€‚ï¼ˆã“ã“ã¯ãŠå¥½ã¿ã§ã©ã†ãï¼‰

```bash
pnpm dlx shadcn@latest init
```

```bash
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
â”‚~/dev/test on â˜ï¸  shinji.takahashi@kikagaku.co.jp(asia-northeast1)
 âœ
â””â”€> pnpm dlx shadcn@latest init
Packages: +220
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Progress: resolved 220, reused 0, downloaded 220, added 220, done
âœ” The path /Users/shinji-takahashi/dev/test does not contain a package.json file.
  Would you like to start a new project? â€º Next.js
âœ” What is your project named? â€¦ use-chat-demo
âœ” Creating a new Next.js project.
âœ” Which color would you like to use as the base color? â€º Neutral
âœ” Writing components.json.
âœ” Checking registry.
âœ” Updating app/globals.css
âœ” Installing dependencies.
âœ” Created 1 file:
  - lib/utils.ts

Success! Project initialization completed.
You may now add components.
```

æœ€è¿‘è©±é¡Œã® Cursor Agent ã« Vercel AI SDK ã® useChat ã‚’ä½¿ã£ã¦ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‚’ä½œã£ã¦ã¨ãŠé¡˜ã„ã—ã¦...

![Cursor Agent](https://storage.googleapis.com/zenn-user-upload/1b5712762db5-20250307.png)

.env.local ã« OpenAI ã® API ã‚­ãƒ¼ã‚’è¨­å®šã—ã¦...

![.env.local](https://storage.googleapis.com/zenn-user-upload/b1a856438865-20250307.png)

å®Œæˆï¼

![ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆå®Œæˆ](https://storage.googleapis.com/zenn-user-upload/65cbc9996ecb-20250307.png)

ã¨ã€ã•ã™ãŒã«ã“ã‚Œã§ã¯å„æ–¹é¢ã«æ€’ã‚‰ã‚Œãã†ãªã®ã§ã€ã‚‚ã†å°‘ã—ã¡ã‚ƒã‚“ã¨ã—ãŸã‚³ãƒ¼ãƒ‰ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## useChat ã®ä½¿ã„æ–¹

ã¨ã„ã£ã¦ã‚‚ã€Vercel AI SDK ã® useChat ã¯ã¨ã£ã¦ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã§ç°¡å˜ã§ã™ã€‚

### Client

```tsx
"use client";

import { useChat } from "@ai-sdk/react";
import { Button } from "@/components/ui/button";
import {
  Card,
  CardContent,
  CardFooter,
  CardHeader,
  CardTitle,
} from "@/components/ui/card";
import { Input } from "@/components/ui/input";
import { Send } from "lucide-react";
import { Message } from "ai";

export function Chat() {
  // input, handleInputChange ãŒ useState ã®ã‚ˆã†ãªã‚‚ã®
  const { messages, input, handleInputChange, handleSubmit } = useChat({
    // API Routes ã®æŒ‡å®šã‚’ã—ã¦ã„ãªã‘ã‚Œã°ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ /api/chat ã‚’ä½¿ã†
    // api: "/api/chat/openai", // API Routes ã‚’æŒ‡å®šã™ã‚‹å ´åˆ
  });

  return (
    <Card className="w-full max-w-2xl mx-auto">
      <CardHeader>
        <CardTitle className="text-xl font-bold">AIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ</CardTitle>
      </CardHeader>
      <CardContent className="space-y-4 max-h-[500px] overflow-y-auto">
        {messages.map((message: Message) => (
          <div
            key={message.id}
            className={`flex ${
              message.role === "user" ? "justify-end" : "justify-start"
            }`}
          >
            <div
              className={`rounded-lg px-4 py-2 max-w-[80%] ${
                message.role === "user"
                  ? "bg-primary text-primary-foreground"
                  : "bg-muted"
              }`}
            >
              {message.content}
            </div>
          </div>
        ))}
      </CardContent>
      <CardFooter>
        <form onSubmit={handleSubmit} className="flex w-full gap-2">
          <Input
            value={input}
            onChange={handleInputChange}
            placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›..."
            className="flex-1"
          />
          <Button type="submit" disabled={!input.trim()}>
            <Send className="h-4 w-4" />
          </Button>
        </form>
      </CardFooter>
    </Card>
  );
}
```

### Server

```tsx
import { streamText } from "ai";
import { openai } from "@ai-sdk/openai";

export async function POST(req: Request) {
  const { messages } = await req.json();

  const stream = streamText({
    model: openai("gpt-4o-mini"),
    messages,
  });

  return stream.toDataStreamResponse();
}
```

ã‹ãªã‚Šã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã­ï¼ã“ã‚Œã ã‘ã§ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å¯¾å¿œã—ãŸãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‚’ä½œã‚Œã¾ã™ã€‚

## useChat è§£èª¬

### ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã‚’æ´»ç”¨ã™ã‚‹

useChat ã«ã¯ã•ã¾ã–ã¾ãªã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ãŒã‚ã‚Šã€ãƒãƒ£ãƒƒãƒˆã®çŠ¶æ…‹å¤‰åŒ–ã«å¿œã˜ãŸå‡¦ç†ã‚’è¿½åŠ ã§ãã¾ã™ã€‚ã“ã“ã§ã¯ã€`onResponse`, `onFinish`, `onError` ã® 3 ã¤ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

```tsx
...

export function ChatWithCallbacks() {
  const { messages, input, handleInputChange, handleSubmit } = useChat({
    // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒé–‹å§‹ã•ã‚ŒãŸã¨ãã«å‘¼ã°ã‚Œã‚‹
    onResponse: (response) => {
      toast.info("ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒé–‹å§‹ã•ã‚Œã¾ã—ãŸ", {
          description: `Status: ${response.status}`,
        });
      },

      // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒå®Œäº†ã—ãŸã¨ãã«å‘¼ã°ã‚Œã‚‹
      onFinish: (message) => {
        toast.info("ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒå®Œäº†ã—ã¾ã—ãŸ", {
          description: `Message: ${JSON.stringify(message)}`,
        });
      },

      // ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸã¨ãã«å‘¼ã°ã‚Œã‚‹
      onError: (error) => {
        toast.error("ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ", {
          description: `Error: ${JSON.stringify(error)}`,
        });
        console.error("ã‚¨ãƒ©ãƒ¼è©³ç´°:", error);
      },
    });

  return (
    ...
  );
}
```

![ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°](https://storage.googleapis.com/zenn-user-upload/46576a1e62c2-20250307.png)

1. **onResponse**: API ã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒé–‹å§‹ã•ã‚ŒãŸã¨ãã«å‘¼ã°ã‚Œã¾ã™ã€‚
2. **onFinish**: ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒå®Œäº†ã—ãŸã¨ãã«å‘¼ã°ã‚Œã¾ã™ã€‚
3. **onError**: ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸã¨ãã«å‘¼ã°ã‚Œã¾ã™ã€‚

ä¾‹ãˆã°ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒé–‹å§‹ã•ã‚ŒãŸã‚‰ãƒãƒ£ãƒƒãƒˆã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã™ã‚‹ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒå®Œäº†ã—ãŸã‚‰ AI ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã™ã‚‹ãªã©ã®å‡¦ç†ã«ä½¿ãˆã¾ã™ã€‚

### useChat ã®æˆ»ã‚Šå€¤

useChat ãƒ•ãƒƒã‚¯ã®æˆ»ã‚Šå€¤ã§ã¯ã€ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç®¡ç†ã™ã‚‹ `status` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ä¸­æ­¢ã™ã‚‹ `stop` ãƒ¡ã‚½ãƒƒãƒ‰ã€ã‚¨ãƒ©ãƒ¼ã‚’å‡¦ç†ã™ã‚‹ `error` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãªã©ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

#### status ã§ UI ã‚’åˆ¶å¾¡ã™ã‚‹

`status` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ã€ç¾åœ¨ã®ãƒãƒ£ãƒƒãƒˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã®çŠ¶æ…‹ã‚’è¡¨ã—ã¾ã™ã€‚ä»¥ä¸‹ã® 4 ã¤ã®å€¤ã®ã„ãšã‚Œã‹ã‚’å–ã‚Šã¾ã™ã€‚

- `"submitted"`: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒ API ã«é€ä¿¡ã•ã‚ŒãŸçŠ¶æ…‹
- `"streaming"`: ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ä¿¡ä¸­ã®çŠ¶æ…‹
- `"ready"`: ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒå®Œäº†ã—ãŸçŠ¶æ…‹
- `"error"`: ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸçŠ¶æ…‹

ã“ã® `status` ã‚’ä½¿ã£ã¦ã€UI ã®çŠ¶æ…‹ã‚’åˆ¶å¾¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

![status](https://storage.googleapis.com/zenn-user-upload/846ea0f223bb-20250307.png)

```tsx
export function ChatWithStatus() {
  const { messages, input, handleInputChange, handleSubmit, status } =
    useChat();

  return (
    <Card className="w-full max-w-2xl mx-auto">
      <CardHeader>
        <CardTitle className="text-xl font-bold">AIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ</CardTitle>
        {status === "submitted" && (
          <div className="text-sm text-muted-foreground animate-pulse">
            AIãŒè€ƒãˆä¸­...
          </div>
        )}
      </CardHeader>
      <CardContent className="space-y-4 max-h-[500px] overflow-y-auto">
        {/* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºéƒ¨åˆ† */}
      </CardContent>
      <CardFooter>
        <form onSubmit={handleSubmit} className="flex w-full gap-2">
          <Input
            value={input}
            onChange={handleInputChange}
            placeholder={
              status === "streaming" ? "AIãŒå¿œç­”ä¸­..." : "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›..."
            }
            className="flex-1"
            disabled={status === "streaming"}
          />
          <Button
            type="submit"
            disabled={!input.trim() || status === "streaming"}
          >
            {status !== "ready" ? (
              <Loader2 className="h-4 w-4 animate-spin" />
            ) : (
              <Send className="h-4 w-4" />
            )}
          </Button>
        </form>
      </CardFooter>
    </Card>
  );
}
```

`status` ã®å€¤ã«å¿œã˜ã¦ï¼š

- å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ç„¡åŠ¹åŒ–
- é€ä¿¡ãƒœã‚¿ãƒ³ã®è¦‹ãŸç›®ã‚’å¤‰æ›´
- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã‚’è¡¨ç¤º

ãªã©ã®åˆ¶å¾¡ãŒå¯èƒ½ã§ã™ã€‚

#### stop ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ä¸­æ­¢ã™ã‚‹

é•·ã„ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ä¿¡ä¸­ã«ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ãŸã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚`stop` é–¢æ•°ã‚’ä½¿ã†ã¨ã€ç¾åœ¨ã® API ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä¸­æ­¢ã§ãã¾ã™ã€‚

```tsx
export function ChatWithStopButton() {
  const { messages, input, handleInputChange, handleSubmit, status, stop } =
    useChat();

  return (
    <Card className="w-full max-w-2xl mx-auto">
      {/* ... */}
      <CardFooter>
        <form onSubmit={handleSubmit} className="flex w-full gap-2">
          <Input
            value={input}
            onChange={handleInputChange}
            placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›..."
            className="flex-1"
            disabled={status === "streaming"}
          />
          {status === "streaming" ? (
            <Button type="button" variant="destructive" onClick={stop}>
              <Square className="h-4 w-4" />
            </Button>
          ) : (
            <Button type="submit" disabled={!input.trim()}>
              <Send className="h-4 w-4" />
            </Button>
          )}
        </form>
      </CardFooter>
    </Card>
  );
}
```

```tsx
// api/chat/route.ts
const stream = streamText({
  model: openai("gpt-4o-mini"),
  messages,
  abortSignal: req.signal, // è¿½åŠ 
});
```

#### error ã§ã‚¨ãƒ©ãƒ¼ã‚’å‡¦ç†ã™ã‚‹

`error` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ã£ã¦ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã®å‡¦ç†ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚

```tsx
export function ChatWithErrorHandling() {
  const { messages, input, handleInputChange, handleSubmit, error } = useChat();

  return (
    <Card className="w-full max-w-2xl mx-auto">
      <CardHeader>
        <CardTitle className="text-xl font-bold">AIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ</CardTitle>
        {/* ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã«ã‚¢ãƒ©ãƒ¼ãƒˆã‚’è¡¨ç¤º */}
        {error && (
          <Alert variant="destructive">
            <AlertCircle className="h-4 w-4" />
            <AlertTitle>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</AlertTitle>
            <AlertDescription>
              {error.message ||
                "ä¸æ˜ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚"}
            </AlertDescription>
          </Alert>
        )}
      </CardHeader>
      <CardContent className="space-y-4 max-h-[500px] overflow-y-auto">
        {/* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºéƒ¨åˆ† */}
      </CardContent>
      <CardFooter>{/* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å…¥åŠ›éƒ¨åˆ† */}</CardFooter>
    </Card>
  );
}
```

## API Routes å´ã® streamText è§£èª¬

### system

`system` ã¯ã€ç”Ÿæˆ AI ã®å¿œç­”ã‚¹ã‚¿ã‚¤ãƒ«ã‚’åˆ¶å¾¡ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã™ã€‚ä¾‹ãˆã°ã€èªå°¾ã¯ãƒ‹ãƒ£ãƒ³ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚ã¨è¨­å®šã™ã‚‹ã¨ã€AI ã®å¿œç­”ãŒãƒ‹ãƒ£ãƒ³ã§çµ‚ã‚ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```tsx
const stream = await streamText({
  model: openai("gpt-4o-mini"),
  messages,
  system: "èªå°¾ã¯ãƒ‹ãƒ£ãƒ³ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚",
  temperature: 0.5,
  topP: 1,
  topK: 1,
});
```

![ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ](https://storage.googleapis.com/zenn-user-upload/1f709958cb6a-20250307.png)

### temperature

`temperature` ã¯ã€ç”Ÿæˆã•ã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆã®å¤šæ§˜æ€§ã‚’åˆ¶å¾¡ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã™ã€‚

0 ã«è¿‘ã„ã»ã©å‡ºåŠ›ãŒå®‰å®šã—äºˆæ¸¬å¯èƒ½ã«ãªã‚Šã€1 ã«è¿‘ã„ã»ã©å‰µé€ çš„ã§å¤šæ§˜ãªå¿œç­”ãŒç”Ÿæˆã•ã‚Œã¾ã™

```tsx
const stream = streamText({
  model: openai("gpt-4o-mini"),
  messages,
  temperature: 0.5,
});
```

### topP

`topP`ï¼ˆnucleus samplingï¼‰ã¯ã€ãƒˆãƒ¼ã‚¯ãƒ³é¸æŠã®ç¢ºç‡åˆ†å¸ƒã‚’åˆ¶å¾¡ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã™ã€‚

ãƒ¢ãƒ‡ãƒ«ã¯ç¢ºç‡ã®é«˜ã„ãƒˆãƒ¼ã‚¯ãƒ³ã‹ã‚‰é †ã«ã€åˆè¨ˆç¢ºç‡ãŒ `topP` ã®å€¤ã«é”ã™ã‚‹ã¾ã§ã®ãƒˆãƒ¼ã‚¯ãƒ³ã®ã¿ã‚’å€™è£œã¨ã—ã¦é¸æŠã—ã¾ã™ã€‚ä¾‹ãˆã°ã€topP=0.9 ã®å ´åˆã€ç¢ºç‡ä¸Šä½ã®ãƒˆãƒ¼ã‚¯ãƒ³ã§ç´¯ç©ç¢ºç‡ãŒ 90%ã«é”ã™ã‚‹ã¾ã§ã®ãƒˆãƒ¼ã‚¯ãƒ³ã ã‘ãŒå€™è£œã«ãªã‚Šã¾ã™ã€‚

å€¤ãŒå°ã•ã„ã»ã©å‡ºåŠ›ãŒå®‰å®šã—ã€å¤§ãã„ã»ã©å¤šæ§˜ãªå¿œç­”ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

```tsx
const stream = streamText({
  model: openai("gpt-4o-mini"),
  messages,
  topP: 0.9,
});
```

### topK

`topK` ã¯ã€å„ã‚¹ãƒ†ãƒƒãƒ—ã§è€ƒæ…®ã™ã‚‹ãƒˆãƒ¼ã‚¯ãƒ³ã®æ•°ã‚’åˆ¶é™ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã™ã€‚

ãƒ¢ãƒ‡ãƒ«ã¯ç¢ºç‡ã®é«˜ã„ä¸Šä½ K å€‹ã®ãƒˆãƒ¼ã‚¯ãƒ³ã®ã¿ã‚’å€™è£œã¨ã—ã¦é¸æŠã—ã¾ã™ã€‚ä¾‹ãˆã°ã€topK=40 ã®å ´åˆã€ç¢ºç‡ä¸Šä½ 40 å€‹ã®ãƒˆãƒ¼ã‚¯ãƒ³ã ã‘ãŒæ¬¡ã®ãƒˆãƒ¼ã‚¯ãƒ³ã®å€™è£œã«ãªã‚Šã¾ã™ã€‚

å€¤ãŒå°ã•ã„ã»ã©å‡ºåŠ›ãŒå®‰å®šã—ã€å¤§ãã„ã»ã©å¤šæ§˜ãªé¸æŠè‚¢ã‹ã‚‰é¸ã°ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```tsx
const stream = streamText({
  model: openai("gpt-4o-mini"),
  messages,
  topK: 40,
});
```

### providerOptions

`providerOptions` ã¯ã€ç”Ÿæˆ AI ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã™ã€‚

ä¾‹ãˆã°ã€å„ãƒ¢ãƒ‡ãƒ«ã§æ¨è«–ã‚’ä½¿ã†å ´åˆãªã©ã«å€‹åˆ¥ã®è¨­å®šã‚’è¡Œãˆã¾ã™ã€‚

```tsx
const stream = streamText({
  model: openai("gpt-4o-mini"),
  messages,
  providerOptions: {
    openai: {
      reasoningEffort: "medium",
    },
  },
});
```

## ã¾ã¨ã‚

ã“ã®è¨˜äº‹ã§ã¯ã€Vercel AI SDK ã® useChat ã‚’ä½¿ã£ã¦ç°¡å˜ã«ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‚’å®Ÿè£…ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã—ãŸï¼

### ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´

- `useChat` ãƒ•ãƒƒã‚¯ã‚’ä½¿ã†ã ã‘ã§ã€ãƒãƒ£ãƒƒãƒˆ UI ã®çŠ¶æ…‹ç®¡ç†ãŒç°¡å˜ã«å®Ÿè£…ã§ãã‚‹
- ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ï¼ˆ`onResponse`ã€`onFinish`ã€`onError`ï¼‰ã‚’æ´»ç”¨ã—ã¦ã€ãƒãƒ£ãƒƒãƒˆã®çŠ¶æ…‹å¤‰åŒ–ã«å¿œã˜ãŸå‡¦ç†ã‚’è¿½åŠ ã§ãã‚‹
- `status` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ã£ã¦ UI ã®çŠ¶æ…‹ã‚’åˆ¶å¾¡ã§ãã‚‹
- `stop` é–¢æ•°ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ä¸­æ­¢ã§ãã‚‹
- `error` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ã‚¨ãƒ©ãƒ¼å‡¦ç†ãŒå¯èƒ½

### ã‚µãƒ¼ãƒãƒ¼å´

- `streamText` é–¢æ•°ã‚’ä½¿ã£ã¦ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ç°¡å˜ã«å®Ÿè£…ã§ãã‚‹
- `system` ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ AI ã®å¿œç­”ã‚¹ã‚¿ã‚¤ãƒ«ã‚’åˆ¶å¾¡ã§ãã‚‹
- `temperature`ã€`topP`ã€`topK` ãªã©ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ç”Ÿæˆãƒ†ã‚­ã‚¹ãƒˆã®å¤šæ§˜æ€§ã‚’èª¿æ•´ã§ãã‚‹
- `providerOptions` ã§å„ AI ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®å›ºæœ‰è¨­å®šã‚’è¡Œãˆã‚‹

Vercel AI SDK ã¯ç”Ÿæˆ AI ã‚’æ´»ç”¨ã—ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã§å¤§æ´»èºã—ã¦ã„ã¾ã™ï¼ç‰¹ã«ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å®Ÿè£…ãŒç°¡å˜ãªã®ãŒéå¸¸ã«å¬‰ã—ã„ã§ã™ã€‚

ãœã²ã“ã®æ©Ÿä¼šã«ã€Vercel AI SDK ã‚’ä½¿ã£ã¦ã¿ã¦ãã ã•ã„ï¼
